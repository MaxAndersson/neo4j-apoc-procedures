 bbb241c6
 bolt-session\tbolt\tneo4j-javascript/4.3.2\t\tclient/10.8.75.2:51686\tserver/10.8.95.10:17687\u003e",


  "query": ["\nMATCH (u:User)-[r1:USER_HAS_FAVORITE]-\u003e(obj)\nWHERE toLower(u.user_email) \u003d toLower($user_email)\nWITH *, collect(obj) as obj ORDER BY r1.order DESC\nCALL apoc.do.case([\n  \"Rule_Element_State\" IN LABELS(obj[0]),\n    \u0027MATCH (lang:Language)\u003c-[:RULE_ELEMENT_STATE_LANGUAGE_IS]-(res:Rule_Element_State)\u003c-[:HAS_RULE_ELEMENT_STATE]-(re:Rule_Element)\n    WHERE id(res) \u003d id(obj[0])\n    OPTIONAL MATCH (res)-[r:RULE_ELEMENT_STATE_LANGUAGE_VERSION_OF]-\u003e(resv:Rule_Element_State)\n    MATCH (re),(rbi:Rule_Book_Issue),\n    path \u003d shortestPath((re)\u003c-[:HAS_RULE_ELEMENT*]-(rbi))\n    WITH *, re, path, MIN(length(path)) as minLength ORDER BY minLength ASC LIMIT 1\n    WITH *, nodes(path)[minLength] as rbi\n    MATCH (rb:Rule_Book)-[:HAS_RULE_BOOK_ISSUE]-\u003e(rbi)-[:HAS_RULE_BOOK_ISSUE_STATE]-\u003e(rbis:Rule_Book_Issue_State)-[:RULE_BOOK_ISSUE_LANGUAGE_IS]-\u003e(lang)\n    WITH collect({ favIdentity: id(r1), favOrder: r1.order, favTimestamp: r1.favorite_timestamp, minLength: minLength, favoriteType: LABELS(obj[0])[0], identity: id(obj[0]), version_of_id: id(resv), res:{ rule_element_title: obj[0].rule_element_title, rule_element_article: obj[0].rule_element_article, rule_element_doc_id: re.rule_element_doc_id, rule_book_issue_title_short: rbis.rule_book_issue_title_short }, iso_639_1: lang.iso_639_1}) as data\n    RETURN data\u0027,\n  LABELS(obj[0]) \u003d [\"Rule_Book\"],\n    \u0027MATCH (rb:Rule_Book { rule_book_id: obj[0].rule_book_id})-[:HAS_RULE_BOOK_ISSUE]-\u003e(rbi:Rule_Book_Issue)-[:HAS_RULE_BOOK_ISSUE_STATE]-\u003e(rbis:Rule_Book_Issue_State)-[:RULE_BOOK_ISSUE_LANGUAGE_IS]-\u003e(lang:Language)\n    WITH collect({ favIdentity: id(r1), favOrder: r1.order, favTimestamp: r1.favorite_timestamp, favoriteType: LABELS(obj[0])[0], identity: id(obj[0]), rb: {rule_book_id: rb.rule_book_id, rule_book_issue_title_long: rbis.rule_book_issue_title_long, rule_book_issue_title_short: rbis.rule_book_issue_title_short}, iso_639_1: lang.iso_639_1 }) as data\n    RETURN data\u0027\n],\n\"\",\n{ obj: obj, r1: r1})\nYIELD value as favorites\nRETURN favorites.data as favorites\n", "\nMATCH (lt:Log_Type)\u003c-[:HAS_LOG_TYPE]-(log:Log)-[:LOG_FOR_USER]-\u003e(u:User {user_email: $user_email})\nWHERE lt.log_type_id IN [68, 47,46,40, 53, 57]\nOPTIONAL MATCH (log)-[:LOG_REFERS_TO_OBJECT]-\u003e(obj)\nWITH *, collect(obj) as obj\nWITH *,  apoc.coll.toSet(obj) as obj ORDER BY log.log_timestamp DESC SKIP toInteger($skip) LIMIT toInteger($limit)\nCALL apoc.do.case([\n  lt.log_type_id \u003d 46 AND \"Rule_Element_State\" IN LABELS(obj[0]),\n    \u0027MATCH (res:Rule_Element_State)\u003c-[:HAS_RULE_ELEMENT_STATE]-(re:Rule_Element)\n    WHERE id(res) \u003d id(obj[0])\n    MATCH (re),(rbi:Rule_Book_Issue),\n    path \u003d shortestPath((re)\u003c-[:HAS_RULE_ELEMENT*]-(rbi))\n    WITH *, re, path, MIN(length(path)) as minLength ORDER BY minLength ASC LIMIT 1\n    WITH *, nodes(path)[minLength] as rbi\n    MATCH (rb:Rule_Book)-[:HAS_RULE_BOOK_ISSUE]-\u003e(rbi)-[:HAS_RULE_BOOK_ISSUE_STATE]-\u003e(rbis:Rule_Book_Issue_State)-[:RULE_BOOK_ISSUE_LANGUAGE_IS]-\u003e(lang:Language)\n    WITH collect({ identity: id(obj[0]), rule_element_title: obj[0].rule_element_title, rule_element_article: obj[0].rule_element_article, rule_element_doc_id: re.rule_element_doc_id, rule_book_issue_title_short: rbis.rule_book_issue_title_short, iso_639_1: lang.iso_639_1}) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 46 AND LABELS(obj[0])[0] \u003d \"Rule_Element\",\n    \u0027MATCH (res:Rule_Element_State)\u003c-[:HAS_RULE_ELEMENT_STATE]-(re:Rule_Element)\n    WHERE id(re) \u003d id(obj[0])\n    MATCH (re),(rbi:Rule_Book_Issue),\n    path \u003d shortestPath((re)\u003c-[:HAS_RULE_ELEMENT*]-(rbi))\n    WITH *, re, path, MIN(length(path)) as minLength ORDER BY minLength ASC LIMIT 1\n    WITH *, nodes(path)[minLength] as rbi\n    MATCH (rb:Rule_Book)-[:HAS_RULE_BOOK_ISSUE]-\u003e(rbi)-[:HAS_RULE_BOOK_ISSUE_STATE]-\u003e(rbis:Rule_Book_Issue_State)-[:RULE_BOOK_ISSUE_LANGUAGE_IS]-\u003e(lang:Language)\n    WITH collect({ identity: id(res), rule_element_title: res.rule_element_title, rule_element_article: res.rule_element_article, rule_element_doc_id: re.rule_element_doc_id, rule_book_issue_title_short: rbis.rule_book_issue_title_short, iso_639_1: lang.iso_639_1}) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 47 AND LABELS(obj[0])[0] \u003d \"Rule_Book\",\n    \u0027MATCH (rb:Rule_Book { rule_book_id: obj[0].rule_book_id})-[:HAS_RULE_BOOK_ISSUE]-\u003e(rbi:Rule_Book_Issue)-[:HAS_RULE_BOOK_ISSUE_STATE]-\u003e(rbis:Rule_Book_Issue_State)-[:RULE_BOOK_ISSUE_LANGUAGE_IS]-\u003e(lang:Language)\n    WITH collect({ identity: id(obj[0]), rule_book_id: rb.rule_book_id, rule_book_issue_title_short: rbis.rule_book_issue_title_short, iso_639_1: lang.iso_639_1 }) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 68 AND LABELS(obj[0])[0] \u003d \"Rule_Book_Struct\",\n    \u0027MATCH (rbs:Rule_Book_Struct { rule_book_struct_id: obj[0].rule_book_struct_id})-[:HAS_RULE_BOOK_STRUCT_STATE]-\u003e(rbss:Rule_Book_Struct_State)-[:RULE_BOOK_STRUCT_LANGUAGE_IS]-\u003e(lang:Language)\n    WITH collect({ identity: id(obj[0]), rule_book_struct_id: rbs.rule_book_struct_id, rule_book_struct_desc: rbss.rule_book_struct_desc, iso_639_1: lang.iso_639_1 }) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 40 AND LABELS(obj[0])[0] \u003d \"Nl\",\n    \u0027MATCH (cou:Country)\u003c-[:NL_REFERS_TO_COUNTRY]-(nl:Nl)-[:HAS_NL_STATE]-\u003e(nls:Nl_State)-[:NL_LANG_IS]-\u003e(lang:Language)\n    WHERE id(nl) \u003d id(obj[0])\n    WITH collect({ nl: properties(nl), nls: { nl_title_short: nls.nl_title_short, nl_title_long: nls.nl_title_long }, iso_639_1: lang.iso_639_1 }) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 53,\n    \u0027WITH collect({ letter: log.log_par_01 }) as data\n    RETURN data\u0027,\n  lt.log_type_id \u003d 57,\n    \u0027WITH collect({ letter: log.log_par_01 }) as data\n    RETURN data\u0027\n],\n\"\",\n{ obj: obj, log: log })\nYIELD value\nWITH collect({ log: properties(log), lt: properties(lt), data: value.data }) as logs\nRETURN logs\n"]
}]