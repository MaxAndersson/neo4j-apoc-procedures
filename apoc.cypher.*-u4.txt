 96916932 (suspected graphql user)

 WITH
    apoc.cypher.runFirstColumn(
        \"MATCH (us {sqlId:$cypherParams.jwt.id})--()
        where us:Expert OR us:User
        UNWIND us as u
        with labels(u) as labels,u
        where labels \u003d [$cypherParams.role]
        RETURN u\",
        {auth: $auth, cypherParams: $cypherParams},
        false
    ) as x
UNWIND
    x as this
WITH
    this
WHERE
   (\"User\" IN labels(this))
RETURN
    head( [ this IN [this] WHERE (\"User\" IN labels(this)) | this { __resolveType: \"User\",  .id, .username, .profilePhotoUrl } ] ) AS this

WITH
    apoc.cypher.runFirstColumn(
        \"CALL db.index.fulltext.queryNodes(\u0027feedSearch\u0027, $q+\u0027~\u0027)
        YIELD node,score as s
        where s \u003e 0
        CALL apoc.when(node:Expert,\u0027MATCH (:Expert {id: node.id})-[:CREATED_BY]-(p:ExpertPost) RETURN p\u0027,\u0027\u0027,{node:node}) YIELD value as post
        CALL apoc.when(node:Feed,\u0027MATCH (p:Feed {id:node.id})  RETURN p\u0027,\u0027\u0027,{node:node}) YIELD value
        with CASE size(keys(post))
            when 1 then post
            else value
            end as n,s
        MATCH (f:Feed {id:n.p.id})
        return f
        order by s
        skip toInteger($offset)
        limit toInteger($limit),
     {auth: $auth, cypherParams: $cypherParams, q: $q, limit: $limit, offset: $offset}, true) as x
UNWIND x as this
WITH this
RETURN this { .id, .content, createdAt: apoc.date.convertFormat(toString(this.createdAt), \"iso_zoned_date_time\", \"iso_offset_date_time\"), byme:  [this_byme IN [(this)-[:LIKED_BY]-\u003e(this_byme) WHERE (\"User\" IN labels(this_byme)) | head( [ this_byme IN [this_byme] WHERE (\"User\" IN labels(this_byme)) AND this_byme.sqlId \u003d $this_byme_User_sqlId | this_byme { __resolveType: \"User\",  .id, .sqlId, .username } ] ) ] WHERE this_byme IS NOT NULL] , .likeCount, .commentCount, .replayCount, .subscriberCount, comments: [ (this)\u003c-[:COMMENT_ON]-(this_comments:UserComment)   | this_comments { .id, .content, createdAt: apoc.date.convertFormat(toString(this_comments.createdAt), \"iso_zoned_date_time\", \"iso_offset_date_time\"), .likeCount, byme:  [this_comments_byme IN [(this_comments)-[:LIKED_BY]-\u003e(this_comments_byme) WHERE (\"User\" IN labels(this_comments_byme)) | head( [ this_comments_byme IN [this_comments_byme] WHERE (\"User\" IN labels(this_comments_byme)) AND this_comments_byme.sqlId \u003d $this_comments_byme_User_sqlId | this_comments_byme { __resolveType: \"User\",  .id, .username } ] ) ] WHERE this_comments_byme IS NOT NULL] , user: head([ (this_comments)-[:COMMENT_BY]-\u003e(this_comments_user:User)   | this_comments_user { .id, .username, .profilePhotoUrl, .sqlId, followedByMe:  [this_comments_user_followedByMe IN [(this_comments_user)\u003c-[:FOLLOWING]-(this_comments_user_followedByMe) WHERE (\"User\" IN labels(this_comments_user_followedByMe)) | head( [ this_comments_user_followedByMe IN [this_comments_user_followedByMe] WHERE (\"User\" IN labels(this_comments_user_followedByMe)) AND this_comments_user_followedByMe.sqlId \u003d $this_comments_user_followedByMe_User_sqlId | this_comments_user_followedByMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_comments_user_followedByMe IS NOT NULL] , followingMe:  [this_comments_user_followingMe IN [(this_comments_user)-[:FOLLOWING]-\u003e(this_comments_user_followingMe) WHERE (\"User\" IN labels(this_comments_user_followingMe)) | head( [ this_comments_user_followingMe IN [this_comments_user_followingMe] WHERE (\"User\" IN labels(this_comments_user_followingMe)) AND this_comments_user_followingMe.sqlId \u003d $this_comments_user_followingMe_User_sqlId | this_comments_user_followingMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_comments_user_followingMe IS NOT NULL]  } ]) } ], replays: [ (this)\u003c-[:REPLAY_TO]-(this_replays:ExpertReplay)   | this_replays { .id, .content, createdAt: apoc.date.convertFormat(toString(this_replays.createdAt), \"iso_zoned_date_time\", \"iso_offset_date_time\"), .likeCount, byme:  [this_replays_byme IN [(this_replays)-[:LIKED_BY]-\u003e(this_replays_byme) WHERE (\"User\" IN labels(this_replays_byme)) | head( [ this_replays_byme IN [this_replays_byme] WHERE (\"User\" IN labels(this_replays_byme)) AND this_replays_byme.sqlId \u003d $this_replays_byme_User_sqlId | this_replays_byme { __resolveType: \"User\",  .id, .username } ] ) ] WHERE this_replays_byme IS NOT NULL] , expert: head([ (this_replays)-[:REPLAY_BY]-\u003e(this_replays_expert:Expert)   | this_replays_expert { .id, .username, .profilePhotoUrl, .sqlId, followedByMe:  [this_replays_expert_followedByMe IN [(this_replays_expert)\u003c-[:FOLLOWING]-(this_replays_expert_followedByMe) WHERE (\"User\" IN labels(this_replays_expert_followedByMe)) | head( [ this_replays_expert_followedByMe IN [this_replays_expert_followedByMe] WHERE (\"User\" IN labels(this_replays_expert_followedByMe)) AND this_replays_expert_followedByMe.sqlId \u003d $this_replays_expert_followedByMe_User_sqlId | this_replays_expert_followedByMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_replays_expert_followedByMe IS NOT NULL] , followingMe:  [this_replays_expert_followingMe IN [(this_replays_expert)-[:FOLLOWING]-\u003e(this_replays_expert_followingMe) WHERE (\"User\" IN labels(this_replays_expert_followingMe)) | head( [ this_replays_expert_followingMe IN [this_replays_expert_followingMe] WHERE (\"User\" IN labels(this_replays_expert_followingMe)) AND this_replays_expert_followingMe.sqlId \u003d $this_replays_expert_followingMe_User_sqlId | this_replays_expert_followingMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_replays_expert_followingMe IS NOT NULL]  } ]) } ], subscribers:  [this_subscribers IN [(this)-[:SUBSCRIBED]-\u003e(this_subscribers) WHERE (\"User\" IN labels(this_subscribers)) | head( [ this_subscribers IN [this_subscribers] WHERE (\"User\" IN labels(this_subscribers)) AND this_subscribers.sqlId \u003d $this_subscribers_User_sqlId | this_subscribers { __resolveType: \"User\",  .id, .username, .sqlId } ] ) ] WHERE this_subscribers IS NOT NULL] , expert: head([ (this)-[:CREATED_BY]-\u003e(this_expert:Expert)   | this_expert { .id, .username, .profilePhotoUrl, .sqlId, followedByMe:  [this_expert_followedByMe IN [(this_expert)\u003c-[:FOLLOWING]-(this_expert_followedByMe) WHERE (\"User\" IN labels(this_expert_followedByMe)) | head( [ this_expert_followedByMe IN [this_expert_followedByMe] WHERE (\"User\" IN labels(this_expert_followedByMe)) AND this_expert_followedByMe.sqlId \u003d $this_expert_followedByMe_User_sqlId | this_expert_followedByMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_expert_followedByMe IS NOT NULL] , followingMe:  [this_expert_followingMe IN [(this_expert)-[:FOLLOWING]-\u003e(this_expert_followingMe) WHERE (\"User\" IN labels(this_expert_followingMe)) | head( [ this_expert_followingMe IN [this_expert_followingMe] WHERE (\"User\" IN labels(this_expert_followingMe)) AND this_expert_followingMe.sqlId \u003d $this_expert_followingMe_User_sqlId | this_expert_followingMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_expert_followingMe IS NOT NULL]  } ]), user: head([ (this)-[:ASKED_BY]-\u003e(this_user:User)   | this_user { .id, .username, .profilePhotoUrl, .sqlId, followedByMe:  [this_user_followedByMe IN [(this_user)\u003c-[:FOLLOWING]-(this_user_followedByMe) WHERE (\"User\" IN labels(this_user_followedByMe)) | head( [ this_user_followedByMe IN [this_user_followedByMe] WHERE (\"User\" IN labels(this_user_followedByMe)) AND this_user_followedByMe.sqlId \u003d $this_user_followedByMe_User_sqlId | this_user_followedByMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_user_followedByMe IS NOT NULL] , followingMe:  [this_user_followingMe IN [(this_user)-[:FOLLOWING]-\u003e(this_user_followingMe) WHERE (\"User\" IN labels(this_user_followingMe)) | head( [ this_user_followingMe IN [this_user_followingMe] WHERE (\"User\" IN labels(this_user_followingMe)) AND this_user_followingMe.sqlId \u003d $this_user_followingMe_User_sqlId | this_user_followingMe { __resolveType: \"User\",  .id } ] ) ] WHERE this_user_followingMe IS NOT NULL]  } ]) } AS this", "
                WITH apoc.cypher.runFirstColumn(\"MATCH (u:User { id: $id}) RETURN u\", {auth: $auth, cypherParams: $cypherParams, id: $id}, false) as x
                UNWIND x as this
                WITH this
            

RETURN this { .id, .username, .profilePhotoUrl, .followerCount, .followingCount, following:  [this_following IN [(this)-[:FOLLOWING]-\u003e(this_following) WHERE (\"Expert\" IN labels(this_following)) OR (\"User\" IN labels(this_following)) | head( [ this_following IN [this_following] WHERE (\"Expert\" IN labels(this_following)) | this_following { __resolveType: \"Expert\",  .id, .username, .profilePhotoUrl, .sqlId, followingMeBack:  [this_following_followingMeBack IN [(this_following)-[:FOLLOWING]-\u003e(this_following_followingMeBack) WHERE (\"User\" IN labels(this_following_followingMeBack)) | head( [ this_following_followingMeBack IN [this_following_followingMeBack] WHERE (\"User\" IN labels(this_following_followingMeBack)) AND this_following_followingMeBack.id \u003d $this_following_followingMeBack_User_id | this_following_followingMeBack { __resolveType: \"User\",  .id } ] ) ] WHERE this_following_followingMeBack IS NOT NULL]  } ] + [ this_following IN [this_following] WHERE (\"User\" IN labels(this_following)) | this_following { __resolveType: \"User\",  .id, .username, .profilePhotoUrl, .sqlId, followingMeBack:  [this_following_followingMeBack IN [(this_following)-[:FOLLOWING]-\u003e(this_following_followingMeBack) WHERE (\"User\" IN labels(this_following_followingMeBack)) | head( [ this_following_followingMeBack IN [this_following_followingMeBack] WHERE (\"User\" IN labels(this_following_followingMeBack)) AND this_following_followingMeBack.id \u003d $this_following_followingMeBack_User_id | this_following_followingMeBack { __resolveType: \"User\",  .id, .username } ] ) ] WHERE this_following_followingMeBack IS NOT NULL]  } ] ) ] WHERE this_following IS NOT NULL] [0..10] , followers:  [this_followers IN [(this)\u003c-[:FOLLOWING]-(this_followers) WHERE (\"Expert\" IN labels(this_followers)) OR (\"User\" IN labels(this_followers)) | head( [ this_followers IN [this_followers] WHERE (\"Expert\" IN labels(this_followers)) | this_followers { __resolveType: \"Expert\",  .id, .username, .profilePhotoUrl, .sqlId, iAmFollowingBack:  [this_followers_iAmFollowingBack IN [(this_followers)\u003c-[:FOLLOWING]-(this_followers_iAmFollowingBack) WHERE (\"User\" IN labels(this_followers_iAmFollowingBack)) | head( [ this_followers_iAmFollowingBack IN [this_followers_iAmFollowingBack] WHERE (\"User\" IN labels(this_followers_iAmFollowingBack)) AND this_followers_iAmFollowingBack.id \u003d $this_followers_iAmFollowingBack_User_id | this_followers_iAmFollowingBack { __resolveType: \"User\",  .id } ] ) ] WHERE this_followers_iAmFollowingBack IS NOT NULL]  } ] + [ this_followers IN [this_followers] WHERE (\"User\" IN labels(this_followers)) | this_followers { __resolveType: \"User\",  .id, .username, .profilePhotoUrl, .sqlId, iAmFollowingBack:  [this_followers_iAmFollowingBack IN [(this_followers)\u003c-[:FOLLOWING]-(this_followers_iAmFollowingBack) WHERE (\"User\" IN labels(this_followers_iAmFollowingBack)) | head( [ this_followers_iAmFollowingBack IN [this_followers_iAmFollowingBack] WHERE (\"User\" IN labels(this_followers_iAmFollowingBack)) AND this_followers_iAmFollowingBack.id \u003d $this_followers_iAmFollowingBack_User_id | this_followers_iAmFollowingBack { __resolveType: \"User\",  .id } ] ) ] WHERE this_followers_iAmFollowingBack IS NOT NULL]  } ] ) ] WHERE this_followers IS NOT NULL] [0..10]  } AS this"]